import{g as S}from"./assets.6f11792f.js";import{T as z}from"./TableFooter.3f00d523.js";import{d as E,c as A,m as M,_ as I,b as m,i as e,j as h,t as o,p as G,x as f,o as u,k as g,G as i,u as H,Y as x,l as Y,a4 as q,F as N,e as J,v as T,ab as Q}from"./index.f8ca9675.js";import{f as O}from"./formatDate.672d0471.js";import{d as k}from"./defaultData.9a1fdc93.js";import{E as W}from"./errorHandler.ce533688.js";const X=E({name:"add-delivery-modal",components:{},props:{CustomerDeliveryData:{type:Object}},setup(t){const{ASSETS_URL:d}=M,v=A(()=>(console.log(t.CustomerDeliveryData),t.CustomerDeliveryData&&t.CustomerDeliveryData.id?{customer:t.CustomerDeliveryData.customer,customer_id:t.CustomerDeliveryData.customer_id,customer_order:t.CustomerDeliveryData.customer_order,id:t.CustomerDeliveryData.id||"",customer_order_id:t.CustomerDeliveryData.customer_order_id||"",tracking_number:t.CustomerDeliveryData.tracking_number||"",status:t.CustomerDeliveryData.status||"",pickup_date:t.CustomerDeliveryData.pickup_date||"",delivery_date:t.CustomerDeliveryData.delivery_date||"",driver:{id:t.CustomerDeliveryData.id||"",created_at:t.CustomerDeliveryData.driver.created_at||"",updated_at:t.CustomerDeliveryData.driver.updated_at||"",firstName:t.CustomerDeliveryData.driver.firstName||"",lastName:t.CustomerDeliveryData.driver.lastName||"",phone_number:t.CustomerDeliveryData.driver.phone_number||"",email:t.CustomerDeliveryData.driver.email||"",profile:t.CustomerDeliveryData.driver.profile||"",city:t.CustomerDeliveryData.driver.city||"",state:t.CustomerDeliveryData.driver.state||"",type:t.CustomerDeliveryData.driver.type||"",title:t.CustomerDeliveryData.driver.title||"",gender:t.CustomerDeliveryData.driver.gender||"",licenseNumber:t.CustomerDeliveryData.driver.licenseNumber||"",licenseExpiration:t.CustomerDeliveryData.driver.licenseExpiration||"",vehicleMake:t.CustomerDeliveryData.driver.vehicleMake||"",vehicleModel:t.CustomerDeliveryData.driver.vehicleModel||"",licensePlate:t.CustomerDeliveryData.driver.licensePlate||"",insurance:t.CustomerDeliveryData.driver.insurance||"",customer_order:t.CustomerDeliveryData.customer_order||null},image:t.CustomerDeliveryData.image||""}:{...k.DeliveryEmpty}));return{getAssetPath:S,CustomerViewDeliveryData:v,ASSETS_URL:d,formatDate:O}}}),Z={class:"modal fade",id:"kt_modal_view_delivery",ref:"viewDeliveryModalRef",tabindex:"-1","aria-hidden":"true"},ee={class:"modal-dialog modal-dialog-centered mw-650px"},te={class:"modal-content"},se={class:"modal-header",id:"kt_modal_add_delivery_header"},ae=e("h2",{class:"fw-bold"},"View Delivery",-1),oe={id:"kt_modal_add_delivery_close","data-bs-dismiss":"modal",class:"btn btn-icon btn-sm btn-active-icon-primary"},re={key:0,class:"card-body p-10"},ie={class:"d-flex flex-center flex-column mb-5"},le={class:"symbol symbol-100px mb-7"},de=["src"],ne={href:"#",class:"fs-3 text-gray-800 text-hover-primary fw-bold mb-1"},ce={class:"d-flex flex-stack fs-4 py-3"},me={class:"fw-bold rotate collapsible","data-bs-toggle":"collapse",href:"#kt_customer_view_details",role:"button","aria-expanded":"false","aria-controls":"kt_customer_view_details"},ue={class:"ms-2 rotate-180"},_e=e("div",{class:"separator separator-dashed my-3"},null,-1),ve={id:"kt_customer_view_details",class:"collapse show"},De={class:"py-5 fs-6"},he={class:"row"},ye={class:"col-6"},fe=e("div",{class:"fw-bold mt-5"},"Driver Name",-1),ge={class:"text-gray-600"},pe={class:"col-6"},be=e("div",{class:"fw-bold mt-5"},"Driver Name",-1),we={class:"text-gray-600"},Ce={class:"col-6"},ke=e("div",{class:"fw-bold mt-5"},"Origin",-1),$e={class:"text-gray-600"},Pe={href:"#",class:"text-gray-600 text-hover-primary"},Ve={class:"row"},xe={class:"col-6"},Ne=e("div",{class:"fw-bold mt-5"},"Destination",-1),Te={class:"text-gray-600"},Se={class:"col-3"},Ee=e("div",{class:"fw-bold mt-5"},"Pickup date",-1),Ae={class:"text-gray-600"},Me={class:"col-3"},Ie=e("div",{class:"fw-bold mt-5"},"Delivery date",-1),Oe={class:"text-gray-600"},Re={class:"row"},Ue={class:"col-6"},Fe=e("div",{class:"fw-bold mt-5"},"Status",-1),Le={class:"text-gray-600"};function je(t,d,v,p,b,y){var l,n,r,c;const _=g("KTIcon");return u(),m("div",Z,[e("div",ee,[e("div",te,[e("div",se,[ae,e("div",oe,[h(_,{"icon-name":"cross","icon-class":"fs-1"})])]),t.CustomerViewDeliveryData.customer_id?(u(),m("div",re,[e("div",ie,[e("div",le,[e("img",{src:t.CustomerViewDeliveryData.image?`${t.ASSETS_URL+t.CustomerViewDeliveryData.image}`:t.getAssetPath("media/avatars/blank.png"),alt:"image"},null,8,de)]),e("a",ne,o(t.CustomerViewDeliveryData.tracking_number),1)]),e("div",ce,[e("div",me,[G(" Details "),e("span",ue,[h(_,{"icon-name":"down","icon-class":"fs-3"})])])]),_e,e("div",ve,[e("div",De,[e("div",he,[e("div",ye,[fe,e("div",ge,o(((l=t.CustomerViewDeliveryData.driver)==null?void 0:l.firstName)+" "+((n=t.CustomerViewDeliveryData.driver)==null?void 0:n.lastName)),1)]),e("div",pe,[be,e("div",we,o(((r=t.CustomerViewDeliveryData.driver)==null?void 0:r.firstName)+" "+((c=t.CustomerViewDeliveryData.driver)==null?void 0:c.lastName)),1)]),e("div",Ce,[ke,e("div",$e,[e("a",Pe,o(t.CustomerViewDeliveryData.customer_order.pickup_address)+" ",1)])])]),e("div",Ve,[e("div",xe,[Ne,e("div",Te,o(t.CustomerViewDeliveryData.customer_order.dropoff_address)+" ",1)]),e("div",Se,[Ee,e("div",Ae,o(t.CustomerViewDeliveryData.pickup_date?t.formatDate(t.CustomerViewDeliveryData.pickup_date):"Not Picked up"),1)]),e("div",Me,[Ie,e("div",Oe,o(t.CustomerViewDeliveryData.delivery_date?t.formatDate(t.CustomerViewDeliveryData.delivery_date):"Not Delivered"),1)])]),e("div",Re,[e("div",Ue,[Fe,e("div",Le,o(t.CustomerViewDeliveryData.status),1)])])])])])):f("",!0)])])],512)}const Be=I(X,[["render",je]]),Ke=E({name:"customer-delivery-stats",components:{TableFooter:z,ViewCustomerDeliveryModal:Be},props:{widgetClasses:String},emits:["page-change","on-sort","on-items-select","on-items-per-page-change"],setup(t,{emit:d}){const{API_URL:v,ASSETS_URL:p}=M,b=i({}),y=i(k.DeliveryEmpty),_=i(k.DeliveryEmpty),l=i(null),n=i(10),r=i([0]),c=i(0),a=H(),{user:$,token:R}=a,U=i(!0),D=i(1),F=i([]);x(()=>n.value,s=>{D.value=1,d("on-items-per-page-change",s)});const L=A(()=>r.value?r.value.length<=n.value?c.value:r.value.length:0),j=async s=>{y.value=s},B=async s=>{console.log(s),_.value=s};x(()=>D.value,async s=>{const w=await V(s);console.log(w),l.value=w});const K=s=>{D.value=s,d("page-change",s)},P=async s=>(await q.get(v+`deliveries/customer/${$.id}?page=${s}`,{headers:{Authorization:`Bearer ${R}`}}).then(C=>C.data).catch(C=>{l.value=null,W(C)})).data,V=async s=>typeof s=="number"?await P(s):await P(1);return Y(async()=>{const s=await V(1);b.value=s,l.value=s.data,c.value=s.total,D.value=s.current_page}),{checkedRows:F,getAssetPath:S,pageChange:K,currentPage:D,itemsPerPage:n,totalDeliveries:r,totalItems:L,dataToDisplay:l,itemsPerPageDropdownEnabled:U,ASSETS_URL:p,editDeliveryData:y,updateEditDelivery:j,CustomerViewDeliveryData:_,updateViewDelivery:B,formatDate:O}}}),ze={class:"card-header border-0 pt-5"},Ge={class:"card-title align-items-start flex-column"},He=e("span",{class:"card-label fw-bold fs-3 mb-1"},"Deliveries",-1),Ye={class:"text-muted mt-1 fw-semobold fs-7"},qe={class:"card-body py-3"},Je={key:0,class:"d-flex align-items-center justify-content-center w-100 py-5"},Qe=e("h4",null,"No Deliveries",-1),We=[Qe],Xe={key:1,class:"d-flex align-items-center justify-content-center w-100 py-5"},Ze=e("div",{class:"spinner-border spinner-border-sm align-middle ms-2 w-25px h-25px"},null,-1),et=[Ze],tt={key:2,class:"table-responsive"},st={class:"table table-row-bordered table-row-gray-100 align-middle gs-0 gy-3"},at=e("thead",null,[e("tr",{class:"fw-bold text-muted"},[e("th",{class:"min-w-150px"},"Order Id"),e("th",{class:"min-w-120px"},"Driver"),e("th",{class:"min-w-140px"},"Origin"),e("th",{class:"min-w-120px"},"Destination"),e("th",{class:"min-w-120px"},"Date"),e("th",{class:"min-w-120px"},"Status"),e("th",{class:"min-w-100px text-end"},"Actions")])],-1),ot={class:"text-dark fw-bold text-hover-primary fs-6"},rt={class:"text-dark fw-bold text-hover-primary fs-6"},it={class:"text-dark fw-bold text-hover-primary d-block mb-1 fs-6"},lt={class:"text-muted fw-semobold text-muted d-block fs-7"},dt={class:"text-dark fw-bold text-hover-primary d-block mb-1 fs-6"},nt={class:"text-muted fw-semobold text-muted d-block fs-7"},ct={class:"text-dark fw-bold text-hover-primary d-block mb-1 fs-6"},mt={class:"text-muted fw-semobold text-muted d-block fs-7"},ut={class:"text-end"},_t=["onClick"],vt={class:"px-10"};function Dt(t,d,v,p,b,y){var r,c;const _=g("KTIcon"),l=g("TableFooter"),n=g("ViewCustomerDeliveryModal");return u(),m(N,null,[e("div",{class:T([t.widgetClasses,"card"])},[e("div",ze,[e("h3",Ge,[He,e("span",Ye,o(t.totalItems)+" Deliveries",1)])]),e("div",qe,[((r=t.dataToDisplay)==null?void 0:r.length)===0?(u(),m("div",Je,We)):f("",!0),t.dataToDisplay?f("",!0):(u(),m("div",Xe,et)),((c=t.dataToDisplay)==null?void 0:c.length)&&t.dataToDisplay?(u(),m("div",tt,[e("table",st,[at,e("tbody",null,[(u(!0),m(N,null,J(t.dataToDisplay,a=>(u(),m("tr",{key:a.id},[e("td",null,[e("span",ot,o(a.tracking_number),1)]),e("td",rt,o(a.driver.firstName+" "+a.driver.lastName),1),e("td",null,[e("span",it,o(a.customer_order.pickup_address),1),e("span",lt,o(a.pickup_date?t.formatDate(a.pickup_date):"Not Picked Up"),1)]),e("td",null,[e("span",dt,o(a.customer_order.dropoff_address),1),e("span",nt,o(a.delivery_date?t.formatDate(a.delivery_date):"Not Dropped Off"),1)]),e("td",null,[e("span",ct,o(a.delivery_date),1),e("span",mt,o(a.pickup_date),1)]),e("td",null,[e("span",{class:T([`badge-light-${a.status}`,"badge"])},o(a.status),3)]),e("td",ut,[e("button",{"data-bs-toggle":"modal","data-bs-target":"#kt_modal_view_delivery",class:"btn btn-icon btn-bg-light btn-active-color-primary btn-sm me-1",onClick:Q($=>t.updateViewDelivery(a),["prevent"])},[h(_,{"icon-name":"switch","icon-class":"fs-3"})],8,_t)])]))),128))])]),e("div",vt,[h(l,{onPageChange:t.pageChange,"current-page":t.currentPage,itemsPerPage:t.itemsPerPage,"onUpdate:itemsPerPage":d[0]||(d[0]=a=>t.itemsPerPage=a),count:t.totalItems,"items-per-page-dropdown-enabled":t.itemsPerPageDropdownEnabled},null,8,["onPageChange","current-page","itemsPerPage","count","items-per-page-dropdown-enabled"])])])):f("",!0)])],2),h(n,{CustomerDeliveryData:t.CustomerViewDeliveryData},null,8,["CustomerDeliveryData"])],64)}const wt=I(Ke,[["render",Dt]]);export{wt as C};
