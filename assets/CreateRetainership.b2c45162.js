import{g as $}from"./assets.6f11792f.js";import{d as S,a5 as x,a6 as T,a7 as V,u as D,G as d,l as E,a4 as g,m as N,_ as F,b as p,j as c,w as C,i as e,k as f,o as h,F as U,e as M,t as P,p as I}from"./index.f8ca9675.js";import{S as w}from"./sweetalert2.d8000a3b.js";import{c as q,a as y}from"./object.a52185a5.js";import{s as z,c as L}from"./citiesInNigeria.a5c184d7.js";import{d as A}from"./defaultData.9a1fdc93.js";import{E as O}from"./errorHandler.ce533688.js";const j=S({name:"add-inventory-modal",components:{ErrorMessage:x,Field:T,VForm:V},setup(){const a=D(),{user:r,token:m,refreshProfile:v}=a,s=d(null),b=d(["",""]),i=d(null),u=d(null),_=d(null),{API_URL:t}=N,l=d(A.RetainershipEmpty),k=q().shape({assignedTo:y().required().label("For Use By"),maxUses:y().required().label("MaxUse")}),R=async()=>{const o=await g.get(t+"customers",{headers:{Authorization:`Bearer ${m}`}}).then(n=>n.data).catch(n=>{w.fire({text:n.message,icon:"error",buttonsStyling:!1,confirmButtonText:"Error Fetching Data!",heightAuto:!1,customClass:{confirmButton:"btn fw-semobold btn-light-danger"}})});_.value=o.data};E(()=>{R()});const B=async()=>{console.log(l.value),s.value&&(s.value.disabled=!0,s.value.setAttribute("data-kt-indicator","on"));const o=new FormData;o.append("customer_id",l.value.assignedTo),o.append("set_num_of_orders",l.value.set_num_of_orders),await g.post(t+"retainerships",o,{headers:{Authorization:`Bearer ${m}`}}).then(()=>{w.fire({text:"Retainership has been created!",icon:"success",buttonsStyling:!1,confirmButtonText:"Ok!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}),l.value=A.CouponEmpty}).catch(n=>{O(n)}).then(()=>{var n;(n=s.value)==null||n.removeAttribute("data-kt-indicator"),s.value.disabled=!1})};return{newCouponData:l,validationSchema:k,submit:async()=>{var o;console.log(l.value),s.value&&(s.value.disabled=!0,s.value.setAttribute("data-kt-indicator","on"),await B(),(o=s.value)==null||o.removeAttribute("data-kt-indicator"),s.value.disabled=!1)},submitButtonRef:s,modalRef:i,createAPIKeyModalRef:u,getAssetPath:$,statesInNigeria:z,citiesInNigeria:L,AllCustomers:_,validity:b}}}),G={class:"card"},H=e("div",{class:"card-header"},[e("h2",{class:"fw-bold my-10"},"Create Retainership")],-1),K={class:"card-body"},J={class:"mb-5 row"},Q={class:"col-6"},W=e("label",{class:"fw-bold required fs-5 fw-semobold mb-2"},"Retainership Instance will be assign to",-1),X=e("option",{value:""},"Select a Customer",-1),Y=e("option",{value:"*"},"Allow Use By All Customers",-1),Z=["value"],ee={class:"fv-plugins-message-container"},se={class:"fv-help-block"},te={class:"col-6"},ae=e("label",{class:"fw-bold required fs-5 fw-semobold mb-2"},"Maximum usage",-1),oe={class:"fv-plugins-message-container"},ne={class:"fv-help-block"},re={class:"card-footer flex-center"},ie=e("button",{type:"reset",class:"btn btn-light me-3"},"Discard",-1),le={ref:"submitButtonRef",type:"submit",id:"kt_create_retainer_submit",class:"btn btn-primary"},de=e("span",{class:"indicator-label"}," Submit ",-1),ce=e("span",{class:"indicator-progress"},[I(" Please wait... "),e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"})],-1),me=[de,ce];function ue(a,r,m,v,s,b){const i=f("Field"),u=f("ErrorMessage"),_=f("VForm");return h(),p("div",G,[H,c(_,{id:"kt_modal_add_customer_form",class:"form",onSubmit:a.submit,"validation-schema":a.validationSchema},{default:C(({})=>[e("div",K,[e("div",J,[e("div",Q,[W,c(i,{name:"assignedTo",class:"form-select",as:"select",modelValue:a.newCouponData.assignedTo,"onUpdate:modelValue":r[0]||(r[0]=t=>a.newCouponData.assignedTo=t)},{default:C(()=>[X,Y,(h(!0),p(U,null,M(a.AllCustomers,t=>(h(),p("option",{key:t.id||t.lastName,value:t.id},P(t.lastName+" "+t.firstName),9,Z))),128))]),_:1},8,["modelValue"]),e("div",ee,[e("div",se,[c(u,{name:"assignedTo"})])])]),e("div",te,[ae,c(i,{type:"number",class:"form-control form-control-solid",placeholder:"Enter Coupon Max use",name:"maxUses","aria-disabled":"true",modelValue:a.newCouponData.set_num_of_orders,"onUpdate:modelValue":r[1]||(r[1]=t=>a.newCouponData.set_num_of_orders=t)},null,8,["modelValue"]),e("div",oe,[e("div",ne,[c(u,{name:"maxUses"})])])])])]),e("div",re,[ie,e("button",le,me,512)])]),_:1},8,["onSubmit","validation-schema"])])}const _e=F(j,[["render",ue]]),pe=S({name:"delivery_records",components:{CreateRetainershipForm:_e},props:{},setup(){return{}}});function fe(a,r,m,v,s,b){const i=f("CreateRetainershipForm");return h(),p("div",null,[c(i,{"widget-classes":"mb-5 mb-xl-8"})])}const Se=F(pe,[["render",fe]]);export{Se as default};
